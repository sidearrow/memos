---
title: '情報処理安全確保支援士 2019 年 秋期 午後 1 大問 1'
description: '情報処理安全確保支援士 2019 年 秋期 午後 1 大問 1'
createdAt: 2020-12-29
updatedAt: 2020-12-29
tags: [ipa-sc, memo]
---

電子メールのセキュリティ対策の問題

## 設問 1

- エンベロープの送信者メールアドレスを指定する SMTP コマンド

|      |                            |
| ---- | -------------------------- |
| HELO | 通信開始                   |
| EHLO | 通信開始（拡張 HELLO）     |
| MAIL | 送信元メールアドレス       |
| RCPT | 宛先メールアドレス         |
| DATA | 本文                       |
| QUIT | 接続終了                   |
| RSET | メールトランザクション中止 |
| NOOP | 疎通確認                   |
| HRLP | ヘルプ                     |

## 設問 2

- SPF, DKIM 認証についての問題
- SPF は電子メールの送信元ドメインが詐称されていないかを検証する仕組み
- 送信側は DNS サーバに SPF レコードとしてドメインと送信元として許可するサーバの IP アドレスを登録
- 受信側はメールの受信時に SPF レコードを DNS で問い合わせて検証

### (1)

- 攻撃者が用意したメールサーバーから送信元を偽装してメールを送信する攻撃に対して、送信元が詐称されているかの判断が可能か
- 送信側の DNS サーバで SPF レコードが登録されているかつ、受信側で SPF レコードの検証を実施する場合、送信元詐称の攻撃に対応することができる

### (2)

- SPF 用の TXT レコード設定

```
<ドメイン名>. IN TXT "v=spf1 +ip4:<IP アドレス> -all"
```

### (3)

- SPF 対応の中継メールサーバが Envelope-FROM を変更せずメールを転送した場合に SPF 認証が失敗する理由
- SPF の検証では Envelope-FROM のドメインと SMTP 送信元の IP アドレスを利用する
- 設問の場合は、送信側の DNS サーバに設定された IP アドレスと SMTP 送信元の IP アドレスが一致せず、認証が失敗する

### (4)

- メール本文及びメールヘッダを基に生成したハッシュ値と公開鍵でディジタル署名を検証すると記載されているため、メール本文及びメールヘッダの改ざんの有無を確認できる

## 設問 3

> DMARC は、メール受信側での SPF と DKIM を利用した検証、検証したメールの取扱い、及び集計レポートについてのポリシを送信側が表明する方法

## 設問 4

- 類似したドメインを取得し、SPF、DKIM、DMARC を利用してメール送信する攻撃は防ぐことができない

## 参考文献

- [Simple Mail Transfer Protocol - Wikipedia](https://ja.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89)
